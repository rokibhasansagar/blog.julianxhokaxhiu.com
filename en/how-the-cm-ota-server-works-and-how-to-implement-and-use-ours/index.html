<!DOCTYPE html><html class="theme-next mist use-motion" lang="en,it,default"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="CV7NWabg4dHSTzScrRzKFAAh0V3TST4qMlcoW7Y_Z3s"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Montserrat:300,300italic,400,400italic,700,700italic|Domine:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css"><meta name="keywords" content="modding,rest,"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2"><meta name="description" content="EDIT: I took the time to develop the first release of the REST API server, you can find it on my Github as always as an OpenSource project.Hello everybody,first of all Happy New Year since it’s the fi"><meta name="keywords" content="modding,rest"><meta property="og:type" content="article"><meta property="og:title" content="[UPDATED] How the LineageOS OTA server works and how to implement and use ours"><meta property="og:url" content="https://blog.julianxhokaxhiu.com/en/how-the-cm-ota-server-works-and-how-to-implement-and-use-ours/index.html"><meta property="og:site_name" content="A Developer&#39;s Blog"><meta property="og:description" content="EDIT: I took the time to develop the first release of the REST API server, you can find it on my Github as always as an OpenSource project.Hello everybody,first of all Happy New Year since it’s the fi"><meta property="og:locale" content="en"><meta property="og:updated_time" content="2017-09-10T12:05:49.313Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="[UPDATED] How the LineageOS OTA server works and how to implement and use ours"><meta name="twitter:description" content="EDIT: I took the time to develop the first release of the REST API server, you can find it on my Github as always as an OpenSource project.Hello everybody,first of all Happy New Year since it’s the fi"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.2",sidebar:{position:"left",display:"post",offset:12,offset_float:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn"}},duoshuo:{userId:"0",author:"Author"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://blog.julianxhokaxhiu.com/en/how-the-cm-ota-server-works-and-how-to-implement-and-use-ours/"><title>[UPDATED] How the LineageOS OTA server works and how to implement and use ours | A Developer's Blog</title><script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-13006157-1","auto"),ga("send","pageview")</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="en"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">A Developer's Blog</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-english"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-globe"></i><br>English</a></li><li class="menu-item menu-item-italiano"><a href="/it" rel="section"><i class="menu-item-icon fa fa-fw fa-globe"></i><br>Italiano</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://blog.julianxhokaxhiu.com/en/how-the-cm-ota-server-works-and-how-to-implement-and-use-ours/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Julian Xhokaxhiu"><meta itemprop="description" content=""><meta itemprop="image" content="/uploads/8bitme.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="A Developer's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">[UPDATED] How the LineageOS OTA server works and how to implement and use ours</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-02-01T18:51:23+01:00">2014-02-01 </time></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/en/how-the-cm-ota-server-works-and-how-to-implement-and-use-ours/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="en/how-the-cm-ota-server-works-and-how-to-implement-and-use-ours/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><p><strong>EDIT:</strong> I took the time to develop the first release of the REST API server, you can find it <a href="https://github.com/julianxhokaxhiu/LineageOTA" target="_blank" rel="external">on my Github</a> as always as an OpenSource project.</p><hr><p>Hello everybody,</p><p>first of all Happy New Year since it’s the first post of 2014 :) Next, you probably may be curious to know what I was doing all these days. Well, since I’m using a custom ROM on my own Galaxy S2 (<a href="http://forum.xda-developers.com/showthread.php?t=2535369" target="_blank" rel="external">CM11 compiled by iNFECTED</a>) I was asking myself “why cannot custom roms use the already built-in OTA by CM with our custom server?</p><p>Well, today I’m here to explain how to it, since I’m really astonished why a bigger community like <a href="http://lineageos.org/" target="_blank" rel="external">LineageOS</a> which loves Open Source does not document or release their public server interface that talks with their ROMs. But hey, we love to hack, right? Let’s get back to business!</p><p>First of all <a href="https://github.com/julianxhokaxhiu/LineageOTAUnitTest" target="_blank" rel="external">clone the Unit Test example</a> on how to call <a href="http://download.cyanogenmod.org" target="_blank" rel="external">the ACTUAL server of LineageOS</a>. You can run this script using <a href="http://nodejs.org/" target="_blank" rel="external">NodeJS</a>. These are the simple steps you have to do to run it and debug it by yourself</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd /path/to/LineageOtaTest</div><div class="line">npm install</div><div class="line">node index.js</div></pre></td></tr></table></figure><p>If all went well, you will see a <code>console.log</code> of the server answer, which will be like this one (I’m using a piece of that from the i9300 channel):</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="string">"id"</span>: <span class="literal">null</span>,</div><div class="line">    <span class="string">"result"</span>: [</div><div class="line">        &#123;</div><div class="line">            <span class="string">"incremental"</span>: <span class="string">"7f96568932"</span>,</div><div class="line">            <span class="string">"api_level"</span>: <span class="number">19</span>,</div><div class="line">            <span class="string">"url"</span>: <span class="string">"http: //get.cm/get/jenkins/57124/cm-11-20140130-NIGHTLY-i9300.zip"</span>,</div><div class="line">            <span class="string">"timestamp"</span>: <span class="string">"1391086037"</span>,</div><div class="line">            <span class="string">"md5sum"</span>: <span class="string">"4e0a335b378035d12cb6626b6623072b"</span>,</div><div class="line">            <span class="string">"changes"</span>: <span class="string">"http: //get.cm/get/jenkins/57124/CHANGES.txt"</span>,</div><div class="line">            <span class="string">"channel"</span>: <span class="string">"nightly"</span>,</div><div class="line">            <span class="string">"filename"</span>: <span class="string">"cm-11-20140130-NIGHTLY-i9300.zip"</span></div><div class="line">        &#125;</div><div class="line">    ],</div><div class="line">    <span class="string">"error"</span>: <span class="literal">null</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>As we may see, the answer is pretty much a simple JSON object with some metadata inside. To replicate by yourself you just have to implement a simple REST API that works on POST requests.</p><p>For generic lists the ROM is using <code>http://download.cyanogenmod.org/api</code> while for DELTA updates is using <code>http://download.cyanogenmod.org/api/v1/build/get_delta</code> .</p><p>If you would like to point to your own server you have two ways doing so:</p><ul><li>Declare <a href="https://github.com/LineageOS/android_packages_apps_CMUpdater/blob/cm-14.1/src/com/cyanogenmod/updater/service/UpdateCheckService.java#L203" target="_blank" rel="external"><code>cm.updater.uri</code></a> on your own <code>build.prop</code> file with the value of you own server URL where you have deployed it</li><li>Replace the string <code>conf_update_server_url_def</code> value inside <code>values.xml</code> of the <a href="https://github.com/lineageos/android_packages_apps_CMUpdater/blob/cm-14.1/res/values/config.xml" target="_blank" rel="external">OTA source code</a></li></ul><p>And that’s it! Possible good points on using your own server would be to provide an OTA update also to all the custom builds based on CM without having to hassle users on going everyday into the topic and reading if it was released something. Also, you can use it to centralize updates on your own Corp if people are using massively LineageOS as their ROMs on their phones.</p><p>As always, thanks for reading and I hope to provide a simple REST server for this on my GitHub so stay tuned :)</p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/modding/" rel="tag"># modding</a> <a href="/tags/rest/" rel="tag"># rest</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/en/extract-your-spotify-playlist-from-google-chrome/" rel="next" title="Extract your Spotify Playlist from Google Chrome"><i class="fa fa-chevron-left"></i> Extract your Spotify Playlist from Google Chrome</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/en/grooveshark-and-deezer-mediakeys-extensions-got-a-bigger-update/" rel="prev" title="Grooveshark and Deezer MediaKeys Extensions got a bigger update!">Grooveshark and Deezer MediaKeys Extensions got a bigger update! <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><section class="site-overview sidebar-panel sidebar-panel-active"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/uploads/8bitme.png" alt="Julian Xhokaxhiu"><p class="site-author-name" itemprop="name">Julian Xhokaxhiu</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">48</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-tags"><span class="site-state-item-count">23</span> <span class="site-state-item-name">tags</span></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://julianxhokaxhiu.com" target="_blank" title="WebSite"><i class="fa fa-fw fa-globe"></i>WebSite</a> </span><span class="links-of-author-item"><a href="https://keybase.io/julianxhokaxhiu" target="_blank" title="KeyBase"><i class="fa fa-fw fa-key"></i>KeyBase</a> </span><span class="links-of-author-item"><a href="https://github.com/julianxhokaxhiu" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://twitter.com/JulianXhokaxhiu" target="_blank" title="Twitter"><i class="fa fa-fw fa-twitter"></i>Twitter</a> </span><span class="links-of-author-item"><a href="https://www.facebook.com/julianxhokaxhiu" target="_blank" title="Facebook"><i class="fa fa-fw fa-facebook"></i>Facebook</a> </span><span class="links-of-author-item"><a href="https://plus.google.com/+JulianXhokaxhiu" target="_blank" title="GooglePlus"><i class="fa fa-fw fa-google-plus"></i>GooglePlus</a> </span><span class="links-of-author-item"><a href="https://www.linkedin.com/in/julianxhokaxhiu" target="_blank" title="Linkedin"><i class="fa fa-fw fa-linkedin"></i>Linkedin</a> </span><span class="links-of-author-item"><a href="https://www.xing.com/profile/Julian_Xhokaxhiu" target="_blank" title="Xing"><i class="fa fa-fw fa-xing"></i>Xing</a> </span><span class="links-of-author-item"><a href="https://bitbucket.org/JulianXhokaxhiu" target="_blank" title="BitBucket"><i class="fa fa-fw fa-bitbucket"></i>BitBucket</a> </span><span class="links-of-author-item"><a href="https://www.stackoverflow.com/users/1518095/julian-xhokaxhiu" target="_blank" title="StackOverflow"><i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a> </span><span class="links-of-author-item"><a href="https://steamcommunity.com/id/julianxhokaxhiu" target="_blank" title="Steam"><i class="fa fa-fw fa-steam-square"></i>Steam</a> </span><span class="links-of-author-item"><a href="https://soundcloud.com/julian-xhokaxhiu" target="_blank" title="SoundCloud"><i class="fa fa-fw fa-soundcloud"></i>SoundCloud</a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2010 &mdash; <span itemprop="copyrightYear">2017</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Julian Xhokaxhiu</span></div><div class="powered-by">Powered by <a class="theme-link" href="https://hexo.io">Hexo</a></div><span class="post-meta-divider">|</span><div class="theme-info">Theme &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.2</div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script><script id="dsq-count-scr" src="https://adevelopersblog.disqus.com/count.js" async></script><script type="text/javascript">var disqus_config=function(){this.page.url="https://blog.julianxhokaxhiu.com/en/how-the-cm-ota-server-works-and-how-to-implement-and-use-ours/",this.page.identifier="en/how-the-cm-ota-server-works-and-how-to-implement-and-use-ours/",this.page.title="[UPDATED] How the LineageOS OTA server works and how to implement and use ours"},d=document,s=d.createElement("script");s.src="https://adevelopersblog.disqus.com/embed.js",s.setAttribute("data-timestamp",""+ +new Date),(d.head||d.body).appendChild(s)</script></body></html>